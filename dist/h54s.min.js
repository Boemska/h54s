!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).h54s=e()}}((function(){return function e(t,r,s){function o(a,i){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!i&&l)return l(a,!0);if(n)return n(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[a]={exports:{}};t[a][0].call(u.exports,(function(e){return o(t[a][1][e]||e)}),u,u.exports,e,t,r,s)}return r[a].exports}for(var n="function"==typeof require&&require,a=0;a<s.length;a++)o(s[a]);return o}({1:[function(e,t,r){function s(e,t,r){Error.captureStackTrace&&Error.captureStackTrace(this),this.message=t,this.type=e,this.status=r}s.prototype=Object.create(Error.prototype,{constructor:{configurable:!1,enumerable:!1,writable:!1,value:s},name:{configurable:!1,enumerable:!1,writable:!1,value:"h54sError"}}),t.exports=s},{}],2:[function(e,t,r){var s=e("../error.js");function o(e,t){this._files={},o.prototype.add.call(this,e,t)}o.prototype.add=function(e,t){if(!e||!t)throw new s("argumentError","Missing arguments");if(!(e instanceof File||e instanceof Blob))throw new s("argumentError","First argument must be instance of File object");if("string"!=typeof t)throw new s("argumentError","Second argument must be string");if(!isNaN(t[t.length-1]))throw new s("argumentError","Macro name cannot have number at the end");this._files[t]=["FILE",e]},t.exports=o},{"../error.js":1}],3:[function(e,t,r){var s=e("./error.js");const o={v9:{url:"/SASStoredProcess/do",loginUrl:"/SASLogon/login",logoutUrl:"/SASStoredProcess/do?_action=logoff",RESTAuthLoginUrl:"/SASLogon/v1/tickets"},viya:{url:"/SASJobExecution/",loginUrl:"/SASLogon/login.do",logoutUrl:"/SASLogon/logout.do?",RESTAuthLoginUrl:""}};var n=t.exports=function(t){if(this.sasVersion=t&&t.sasVersion||"v9",this.debug=t&&t.debug||!1,this.metadataRoot=t&&t.metadataRoot||"",this.url=o[this.sasVersion].url,this.loginUrl=o[this.sasVersion].loginUrl,this.logoutUrl=o[this.sasVersion].logoutUrl,this.RESTauth=!1,this.RESTauthLoginUrl=o[this.sasVersion].RESTAuthLoginUrl,this.retryAfterLogin=!0,this.maxXhrRetries=5,this.ajaxTimeout=t&&t.ajaxTimeout||3e5,this.useMultipartFormData=t&&t.useMultipartFormData||!0,this.csrf="",this.isViya="viya"===this.sasVersion,this.remoteConfigUpdateCallbacks=[],this._pendingCalls=[],this._customPendingCalls=[],this._disableCalls=!1,this._ajax=e("./methods/ajax.js")(),n.call(this,t),t&&t.isRemoteConfig){var r=this;this._disableCalls=!0,this._ajax.get("h54sConfig.json").success((function(e){var s=JSON.parse(e.responseText);for(let e in s)s.hasOwnProperty(e)&&"isRemoteConfig"!==e&&(t[e]=s[e]);n.call(r,t);for(var o=0,a=r.remoteConfigUpdateCallbacks.length;o<a;o++){(0,r.remoteConfigUpdateCallbacks[o])()}for(r._disableCalls=!1;r._pendingCalls.length>0;){const e=r._pendingCalls.shift(),t=e.options.sasProgram,s=e.options.callback,o=e.params;o._debug=r.debug?131:0,r.metadataRoot&&-1===o._program.indexOf(r.metadataRoot)&&(o._program=r.metadataRoot.replace(/\/?$/,"/")+o._program.replace(/^\//,"")),o._debug=r.debug?131:0,r.call(t,null,s,o)}for(;r._customPendingCalls.length>0;){const e=r._customPendingCalls.shift(),t=e.callMethod,s=e._url,o=e.options;r.metadataRoot&&o.params&&-1===o.params._program.indexOf(r.metadataRoot)&&(o.params._program=r.metadataRoot.replace(/\/?$/,"/")+o.params._program.replace(/^\//,"")),o.params&&(o.params._debug=r.debug?131:0),r.managedRequest(t,s,o)}})).error((function(e){throw new s("ajaxError","Remote config file cannot be loaded. Http status code: "+e.status)}))}function n(e){if(e){if("object"!=typeof e)throw new s("argumentError","First parameter should be config object");for(var t in e)e.hasOwnProperty(t)&&("url"!==t&&"loginUrl"!==t||"/"===e[t].charAt(0)||(e[t]="/"+e[t]),this[t]=e[t]);e.hostUrl&&("/"===e.hostUrl.charAt(e.hostUrl.length-1)&&(e.hostUrl=e.hostUrl.slice(0,-1)),this.hostUrl=e.hostUrl,this.url.includes(this.hostUrl)||(this.url=e.hostUrl+this.url),this.loginUrl.includes(this.hostUrl)||(this.loginUrl=e.hostUrl+this.loginUrl),this.RESTauthLoginUrl.includes(this.hostUrl)||(this.RESTauthLoginUrl=e.hostUrl+this.RESTauthLoginUrl)),this._ajax.setTimeout(this.ajaxTimeout)}else this._ajax.setTimeout(this.ajaxTimeout)}};n.version="1.0.0",n.prototype=e("./methods"),n.Tables=e("./tables"),n.Files=e("./files"),n.SasData=e("./sasData.js"),n.fromSasDateTime=e("./methods/utils.js").fromSasDateTime,n.toSasDateTime=e("./tables/utils.js").toSasDateTime,e("./ie_polyfills.js")},{"./error.js":1,"./files":2,"./ie_polyfills.js":4,"./methods":7,"./methods/ajax.js":6,"./methods/utils.js":8,"./sasData.js":9,"./tables":10,"./tables/utils.js":11}],4:[function(e,t,r){t.exports=(Object.create||(Object.create=function(e,t){if(void 0!==t)throw"The multiple-argument version of Object.create is not provided by this browser and cannot be shimmed.";function r(){}return r.prototype=e,new r}),Object.keys||(Object.keys=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=r.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var n,a,i=[];for(n in o)e.call(o,n)&&i.push(n);if(t)for(a=0;a<s;a++)e.call(o,r[a])&&i.push(r[a]);return i}}()),void(Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){"use strict";if(null==this)throw new TypeError;var t,r,s=Object(this),o=s.length>>>0;if(0===o)return-1;for(t=o-1,arguments.length>1&&((t=Number(arguments[1]))!=t?t=0:0!==t&&t!=1/0&&t!=-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),r=t>=0?Math.min(t,o-1):o-Math.abs(t);r>=0;r--)if(r in s&&s[r]===e)return r;return-1})))},{}],5:[function(e,t,r){var s={applicationLogs:[],debugData:[],sasErrors:[],failedRequests:[]},o=100,n=20,a=20,i=100;t.exports.get={getSasErrors:function(){return s.sasErrors},getApplicationLogs:function(){return s.applicationLogs},getDebugData:function(){return s.debugData},getFailedRequests:function(){return s.failedRequests},getAllLogs:function(){return{sasErrors:s.sasErrors,applicationLogs:s.applicationLogs,debugData:s.debugData,failedRequests:s.failedRequests}}},t.exports.clear={clearApplicationLogs:function(){s.applicationLogs.splice(0,s.applicationLogs.length)},clearDebugData:function(){s.debugData.splice(0,s.debugData.length)},clearSasErrors:function(){s.sasErrors.splice(0,s.sasErrors.length)},clearFailedRequests:function(){s.failedRequests.splice(0,s.failedRequests.length)},clearAllLogs:function(){this.clearApplicationLogs(),this.clearDebugData(),this.clearSasErrors(),this.clearFailedRequests()}},t.exports.addApplicationLog=function(e,t){if("blank"!==e){var r={message:e,time:new Date,sasProgram:t};s.applicationLogs.push(r),s.applicationLogs.length>o&&s.applicationLogs.shift()}},t.exports.addDebugData=function(e,t,r,o){s.debugData.push({debugHtml:e,debugText:t,sasProgram:r,params:o,time:new Date}),s.debugData.length>n&&s.debugData.shift()},t.exports.addFailedRequest=function(e,t,r){s.failedRequests.push({responseHtml:e,responseText:t,sasProgram:r,time:new Date}),s.failedRequests.length>a&&s.failedRequests.shift()},t.exports.addSasErrors=function(e){for(s.sasErrors=s.sasErrors.concat(e);s.sasErrors.length>i;)s.sasErrors.shift()}},{}],6:[function(e,t,r){t.exports=function(){var e,t=3e4,r=function(r,s,o,n,a={}){var i={success:function(){},error:function(){}},l=new XMLHttpRequest("MSXML2.XMLHTTP.3.0");return l.open(r,s,!0),n||(a["Content-Type"]?l.setRequestHeader("Content-Type",a["Content-Type"]):l.setRequestHeader("Content-Type","application/x-www-form-urlencoded")),Object.keys(a).forEach(e=>{"Content-Type"!==e&&l.setRequestHeader(e,a[e])}),l.onreadystatechange=function(){4===l.readyState&&(clearTimeout(e),l.status>=200&&l.status<300?i.success.call(i,l):i.error.call(i,l))},t>0&&(e=setTimeout((function(){l.abort()}),t)),l.send(o),{success:function(e){return i.success=e,this},error:function(e){return i.error=e,this}}};const s=function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r))if(e[r]instanceof Array)for(var s=0,o=e[r].length;s<o;s++)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r][s]));else t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")};var o=function(e){var t=new FormData;for(var r in e)if(e.hasOwnProperty(r))if(e[r]instanceof Array&&"file"!==r)for(var s=0,o=e[r].length;s<o;s++)t.append(r,e[r][s]);else"file"===r?t.append(r,e[r][0],e[r][1]):t.append(r,e[r]);return t};return{get:function(e,t,o,n){var a;return"object"==typeof t&&(a=s(t)),r("GET",a?e+"?"+a:e,null,o,n)},post:function(e,t,n,a){let i=t;return"object"==typeof t&&(i=n?o(t):s(t)),r("POST",e,i,n,a)},put:function(e,t,s,n){let a=t;return"object"==typeof t&&s&&(a=o(t)),r("PUT",e,a,s,n)},delete:function(e,t,s,o){return r("DELETE",e,t,null,o)},setTimeout:function(e){t=e},serialize:s}}},{}],7:[function(e,t,r){var s=e("../error.js"),o=e("../logs.js"),n=e("../tables"),a=e("../sasData.js"),i=e("../files");function l(e,t,r){var s=this,n={_service:"default",username:e,password:t};for(var a in this._aditionalLoginParams)n[a]=this._aditionalLoginParams[a];function i(e){449!=e.status?(o.addApplicationLog("Login failed with status code: "+e.status),r(e.status)):l(e)}function l(e){if(3==++s._loginAttempts)return r(-2);if(s._utils.needToLogin.call(s,e))if(s._loginChanged||s._isNewLoginPage&&!s._aditionalLoginParams){delete s._loginChanged;var t=e.responseText.match(/<input.*"hidden"[^>]*>/g);t&&t.forEach((function(e){var t=e.match(/name="([^"]*)"\svalue="([^"]*)/);n[t[1]]=t[2]})),s._ajax.post(s.loginUrl,n).success((function(){s._ajax.get(s.url).success(l).error(i)})).error(i)}else o.addApplicationLog("Wrong username or password"),r(-1);else for(s._disableCalls=!1,r(e.status);s._pendingCalls.length>0;){var a=s._pendingCalls.shift(),c=a.method||s.call.bind(s),u=a.options.sasProgram,p=a.options.callback,g=a.params;g._debug=s.debug?131:0,s.retryAfterLogin&&c(u,null,p,g)}}this._loginAttempts=0,this._ajax.post(this.loginUrl,n).success(l).error(i)}function c(e,t,r){var s=this,n={username:e,password:t};this._ajax.post(this.RESTauthLoginUrl,n).success((function(e){var t=e.getResponseHeader("Location");s._ajax.post(t,{service:s.url}).success((function(e){-1===s.url.indexOf("?")?s.url+="?ticket="+e.responseText:-1!==s.url.indexOf("ticket")?s.url=s.url.replace(/ticket=[^&]+/,"ticket="+e.responseText):s.url+="&ticket="+e.responseText,r(e.status)})).error((function(e){o.addApplicationLog("Login failed with status code: "+e.status),r(e.status)}))})).error((function(e){"error.authentication.credentials.bad"===e.responseText?r(-1):(o.addApplicationLog("Login failed with status code: "+e.status),r(e.status))}))}for(var u in t.exports.call=function(e,t,r,l){var c,u,p=this,g=0,h=this.debug,f=this.csrf;if(!r||"function"!=typeof r)throw new s("argumentError","You must provide a callback");if(!e)throw new s("argumentError","You must provide Sas program file path");if("string"!=typeof e)throw new s("argumentError","First parameter should be string");if(!1===this.useMultipartFormData&&!(t instanceof n))throw new s("argumentError","Cannot send files using application/x-www-form-urlencoded. Please use Tables or default value for useMultipartFormData");if(l=l?Object.assign({},l,{_csrf:f}):{_program:this._utils.getFullProgramPath(this.metadataRoot,e),_debug:this.debug?131:0,_service:"default",_csrf:f},t)for(c in t instanceof n?u=t._tables:t instanceof i||t instanceof a?u=t._files:console.log(new s("argumentError","Wrong type of tables object")),u)u.hasOwnProperty(c)&&(l[c]=u[c]);this._disableCalls?this._pendingCalls.push({params:l,options:{sasProgram:e,dataObj:t,callback:r}}):this._ajax.post(this.url,l,this.useMultipartFormData).success((async function(a){if(p._utils.needToLogin.call(p,a)){if(p._pendingCalls.push({params:l,options:{sasProgram:e,dataObj:t,callback:r}}),p._disableCalls)return;p._disableCalls=!0,r(new s("notLoggedinError","You are not logged in"))}else{var i,c,u,f=!1;if(h)try{i=await p._utils.parseDebugRes(a.responseText,e,l,p.hostUrl,p.isViya,p.managedRequest.bind(p)),o.addApplicationLog(i.logmessage,e),c=t instanceof n?p._utils.unescapeValues(i):i,"success"!==i.status&&(u=new s("programError",i.errormessage,i.status)),f=!0}catch(t){t instanceof SyntaxError?(u=new s("parseError",t.message),f=!0):t instanceof s?"parseError"===t.type&&g<1?(f=!1,p._ajax.post(p.url,l,p.useMultipartFormData).success(this.success).error(this.error),g++,o.addApplicationLog("Retrying #"+g,e)):(u=t instanceof s?t:new s("parseError","Unable to parse response json"),f=!0):((u=new s("unknownError",t.message)).stack=t.stack,f=!0)}finally{f&&r(u,c)}else try{i=p._utils.parseRes(a.responseText,e,l),o.addApplicationLog(i.logmessage,e),c=t instanceof n?p._utils.unescapeValues(i):i,"success"!==i.status&&(u=new s("programError",i.errormessage,i.status)),f=!0}catch(t){t instanceof SyntaxError?g<p.maxXhrRetries?(f=!1,p._ajax.post(p.url,l,p.useMultipartFormData).success(this.success).error(this.error),g++,o.addApplicationLog("Retrying #"+g,e)):(p._utils.parseErrorResponse(a.responseText,e),p._utils.addFailedResponse(a.responseText,e),u=new s("parseError","Unable to parse response json"),f=!0):t instanceof s?(p._utils.parseErrorResponse(a.responseText,e),p._utils.addFailedResponse(a.responseText,e),u=t,f=!0):(p._utils.parseErrorResponse(a.responseText,e),p._utils.addFailedResponse(a.responseText,e),(u=new s("unknownError",t.message)).stack=t.stack,f=!0)}finally{f&&r(u,c)}}})).error((function(t){let n;449==t.status||403==t.status&&(t.responseText.includes("_csrf")||"CSRF"===t.getResponseHeader("X-Forbidden-Reason"))&&(n=t.getResponseHeader(t.getResponseHeader("X-CSRF-HEADER")))?(l._csrf=n,p.csrf=n,g<p.maxXhrRetries?(p._ajax.post(p.url,l,!0).success(this.success).error(this.error),g++,o.addApplicationLog("Retrying #"+g,e)):(p._utils.parseErrorResponse(t.responseText,e),p._utils.addFailedResponse(t.responseText,e),r(new s("parseError","Unable to parse response json")))):(o.addApplicationLog("Request failed with status: "+t.status,e),r(new s("httpError",t.statusText)))}))},t.exports.login=function(e,t,r){if(!e||!t)throw new s("argumentError","Credentials not set");if("string"!=typeof e||"string"!=typeof t)throw new s("argumentError","User and pass parameters must be strings");if(!r||"function"!=typeof r)throw new s("argumentError","You must provide callback");this.RESTauth?c.call(this,e,t,r):l.call(this,e,t,r)},t.exports.managedRequest=function(e="get",t,r={callback:()=>console.log("Missing callback funciton")}){const n=this,a=this.csrf;let i=0;const{useMultipartFormData:l,sasProgram:c,dataObj:u,params:p,callback:g,headers:h}=r;if(c)return n.call(c,u,g,p);let f=t;t.startsWith("http")||(f=n.hostUrl+t);const d=Object.assign({},h,{"X-CSRF-TOKEN":a}),m=Object.assign({},r,{headers:d});this._disableCalls?this._customPendingCalls.push({callMethod:e,_url:t,options:m}):n._ajax[e](f,p,l,d).success((function(r){if(n._utils.needToLogin.call(n,r)){if(n._customPendingCalls.push({callMethod:e,_url:t,options:m}),n._disableCalls)return;n._disableCalls=!0,g(new s("notLoggedinError","You are not logged in"))}else{let e,t,o=!1;try{const s=r.getAllResponseHeaders().split("\r\n").reduce((function(e,t,r){let s=t.split(": ");return e[s[0]]=s[1],e}),{});let n=r.responseText;try{n=JSON.parse(n)}catch(e){console.log("response is not JSON string")}finally{e=Object.assign({},{headers:s,status:r.status,statusText:r.statusText,body:n}),o=!0}}catch(e){t=new s("unknownError",e.message),t.stack=e.stack,o=!0}finally{o&&g(t,e)}}})).error((function(r){let a;if(449==r.status||403==r.status&&(r.responseText.includes("_csrf")||"CSRF"===r.getResponseHeader("X-Forbidden-Reason"))&&(a=r.getResponseHeader(r.getResponseHeader("X-CSRF-HEADER")))){n.csrf=a;const t=Object.assign({},h,{[r.getResponseHeader("X-CSRF-HEADER")]:a});i<n.maxXhrRetries?(n._ajax[e](f,p,l,t).success(this.success).error(this.error),i++):g(new s("parseError","Unable to parse response json"))}else o.addApplicationLog("Managed request failed with status: "+r.status,t),g(new s("httpError1",r.responseText,r.status))}))},t.exports.logout=function(e){var t=(this.hostUrl||"")+this.logoutUrl;this._ajax.get(t).success((function(t){this._disableCalls=!0,e()})).error((function(t){o.addApplicationLog("Logout failed with status code: "+t.status),e(t.status)}))},t.exports.setDebugMode=function(){this.debug=!0},t.exports.unsetDebugMode=function(){this.debug=!1},o.get)o.get.hasOwnProperty(u)&&(t.exports[u]=o.get[u]);for(var u in o.clear)o.clear.hasOwnProperty(u)&&(t.exports[u]=o.clear[u]);function p(e,t,r){const s=this;let n={_service:"default",username:e,password:t};for(let e in this._aditionalLoginParams)n[e]=this._aditionalLoginParams[e];function a(e){449==e.status?i(e):(o.addApplicationLog("Login failed with status code: "+e.status),r(e.status))}function i(e){if(3==++s._loginAttempts&&r(-2),s._utils.needToLogin.call(s,e))if(s._loginChanged||s._isNewLoginPage&&!s._aditionalLoginParams){delete s._loginChanged;const t=e.responseText.match(/<input.*"hidden"[^>]*>/g);t&&t.forEach((function(e){const t=e.match(/name="([^"]*)"\svalue="([^"]*)/);n[t[1]]=t[2]})),s._ajax.post(s.loginUrl,n).success((function(){i()})).error(a)}else o.addApplicationLog("Wrong username or password"),r(-1);else{for(s._disableCalls=!1,r(e.status);s._customPendingCalls.length>0;){const e=s._customPendingCalls.shift(),t=e.method||s.managedRequest.bind(s),r=e.callMethod,o=e._url,n=e.options;n.params&&(n.params._debug=s.debug?131:0),s.retryAfterLogin&&t(r,o,n)}for(;s._pendingCalls.length>0;){const e=s._pendingCalls.shift(),t=e.method||s.call.bind(s),r=e.options.sasProgram,o=e.options.callback,n=e.params;n._debug=s.debug?131:0,s.retryAfterLogin&&t(r,null,o,n)}}}this._loginAttempts=0,n=this._ajax.serialize(n),this._ajax.post(this.loginUrl,n).success(i).error(a)}function g(e,t,r,s){var n=this,a={username:e,password:t};this._ajax.post(this.RESTauthLoginUrl,a).success((function(e){var t=e.getResponseHeader("Location");n._ajax.post(t,{service:s}).success((function(e){-1===s.indexOf("?")?s+="?ticket="+e.responseText:-1!==s.indexOf("ticket")?s=s.replace(/ticket=[^&]+/,"ticket="+e.responseText):s+="&ticket="+e.responseText,r(e.status)})).error((function(e){o.addApplicationLog("Login failed with status code: "+e.status),r(e.status)}))})).error((function(e){"error.authentication.credentials.bad"===e.responseText?r(-1):(o.addApplicationLog("Login failed with status code: "+e.status),r(e.status))}))}t.exports.onRemoteConfigUpdate=function(e){this.remoteConfigUpdateCallbacks.push(e)},t.exports._utils=e("./utils.js"),t.exports.promiseLogin=function(e,t){return new Promise((r,o)=>{e&&t||o(new s("argumentError","Credentials not set")),"string"==typeof e&&"string"==typeof t||o(new s("argumentError","User and pass parameters must be strings")),this.RESTauth?g.call(this,e,t,r):p.call(this,e,t,r)})},t.exports.getFolderDetails=function(e,t){let r="/folders/folders/@item?path="+e;return this.managedRequest("get",r,t)},t.exports.getFileDetails=function(e,t){return t.cacheBust&&(e+="?cacheBust="+(new Date).getTime()),this.managedRequest("get",e,t)},t.exports.getFileContent=function(e,t){let r=e+"/content";return t.cacheBust&&(r+="?cacheBust="+(new Date).getTime()),this.managedRequest("get",r,t)},t.exports.getFolderContents=async function(e,t){const r=this,{callback:s}=t;let o="/folders/folders/@item?path="+e;const n=Object.assign({},t,{callback:(e,t)=>{let o="/folders/folders/"+t.body.id+"/members/?limit=10000000";return r.managedRequest("get",o,{callback:s})}});this.managedRequest("get",o,n)},t.exports.createNewFolder=function(e,t,r){var s="/folders/folders?parentFolderUri="+e,o={name:t,type:"folder"};const n=Object.assign({},r,{params:JSON.stringify(o),headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/json"},useMultipartFormData:!1});return this.managedRequest("post",s,n)},t.exports.deleteFolderById=function(e,t){var r="/folders/folders/"+e;return this.managedRequest("delete",r,t)},t.exports.createNewFile=function(e,t,r,s){let o={file:[t,e],parentFolderUri:r};const n=Object.assign({},s,{params:o,useMultipartFormData:!0});return this.managedRequest("post","/files/files#multipartUpload",n)},t.exports.deleteItem=function(e,t){return this.managedRequest("delete",e,t)},t.exports.updateFile=function(e,t,r,s){const o=e+"/content";console.log("URL",o);let n={"Content-Type":"application/vnd.sas.file","If-Unmodified-Since":r};const a=Object.assign({},s,{params:t,headers:n,useMultipartFormData:!1});return this.managedRequest("put",o,a)}},{"../error.js":1,"../files":2,"../logs.js":5,"../sasData.js":9,"../tables":10,"./utils.js":8}],8:[function(e,t,r){var s=e("../logs.js"),o=e("../error.js"),n=/<title>(Stored Process Error|SASStoredProcess)<\/title>[\s\S]*<h2>(Stored process not found:.*|.*not a valid stored process path.)<\/h2>/;t.exports.parseRes=function(e,t,r){if(e.match(n))throw new o("programNotFound","You have not been granted permission to perform this action, or the STP is missing.");return JSON.parse(e)},t.exports.parseDebugRes=function(e,t,r,a,i){let l=e.match(n);if(l)throw new o("programNotFound","Sas program completed with errors");if(i){if(e.match("<h2>Parameter Error <br/>Unable to get job definition.</h2>"))throw new o("programNotFound","Sas program completed with errors. Unable to get job definition.")}let c=i?/^(.?<iframe.*src=")([^"]+)(.*iframe>)/m:/^(.?--h54s-data-start--)([\S\s]*?)(--h54s-data-end--)/m;l=e.match(c);const u=e.replace(c,"").match(/<body.*>([\s\S]*)<\/body>/);let p,g=u[1].replace(/<[^>]*>/g,"");if(g=this.decodeHTMLEntities(g),s.addDebugData(u[1],g,t,r),i&&this.parseErrorResponse(e,t))throw new o("sasError","Sas program completed with errors");if(!l)throw new o("parseError","Unable to parse response json");if(i){const e=new XMLHttpRequest,t=a||"";e.open("GET",t+l[2],!1),e.send();const r=e.responseText;return p=JSON.parse(r.replace(/(\r\n|\r|\n)/g,"")),p}try{p=JSON.parse(l[2])}catch(e){throw new o("parseError","Unable to parse response json")}if(p&&p.h54sAbort)return p;if(this.parseErrorResponse(e,t))throw new o("sasError","Sas program completed with errors");return p},t.exports.addFailedResponse=function(e,t){var r=(e=e.replace(/<script([\s\S]*)\/form>/,"").replace(/display\s?:\s?none;?\s?/,"")).replace(/<[^>]*>/g,"");r=this.decodeHTMLEntities(r),s.addFailedRequest(e,r,t)},t.exports.unescapeValues=function(e){for(var t in e)"string"==typeof e[t]?e[t]=decodeURIComponent(e[t]):"object"==typeof e&&this.unescapeValues(e[t]);return e},t.exports.parseErrorResponse=function(e,t){var r=e.replace(/(<([^>]+)>)/gi,"").match(/^ERROR(:\s|\s\d\d)(.*\.|.*\n.*\.)/gm);if(r){for(var o,n=0,a=r.length;n<a;n++)o=r[n].replace(/<[^>]*>/g,"").replace(/(\n|\s{2,})/g," "),o=this.decodeHTMLEntities(o),r[n]={sasProgram:t,message:o,time:new Date};return s.addSasErrors(r),!0}},t.exports.decodeHTMLEntities=function(e){var t=document.createElement("span");return e.replace(/&(#(?:x[0-9a-f]+|\d+)|[a-z]+);/gi,(function(e){return t.innerHTML=e,e=t.textContent||t.innerText}))},t.exports.fromSasDateTime=function(e){var t=new Date("January 1, 1960 00:00:00"),r=e,s=t.getTimezoneOffset(),o=1e3*r+t.getTime(),n=new Date;n.setTime(o);var a=o-60*(s-n.getTimezoneOffset())*1e3;return n.setTime(a),n},t.exports.needToLogin=function(e){var t,r=/<form.+action="(.*Logon[^"]*).*>/.exec(e.responseText);if(r){var s=r[1].replace(/\?.*/,"");if("/"===s.charAt(0))(t=this.hostUrl?this.hostUrl+s:s)!==this.loginUrl&&(this._loginChanged=!0,this.loginUrl=t);else{var o=e.responseURL.lastIndexOf("/")+1,n=e.responseURL.substr(0,o).replace(/.*\/{2}[^\/]*/,"")+s;(t=this.hostUrl?this.hostUrl+n:n)!==this.loginUrl&&(this._loginChanged=!0,this.loginUrl=t)}var a=(new DOMParser).parseFromString(e.responseText,"text/html").querySelectorAll("input[type='hidden']"),i={};return a&&(this._isNewLoginPage=!0,a.forEach((function(e){i[e.name]=e.value})),this._aditionalLoginParams=i),!0}return!1},t.exports.getFullProgramPath=function(e,t){return e?e.replace(/\/?$/,"/")+t.replace(/^\//,""):t},t.exports.getObjOfTable=function(e,t,r=null){const s={};return e.forEach(e=>{s[e[t]]=r?e[r]:e}),s},t.exports.getSelfUri=function(e){return e.filter(e=>"self"===e.rel).map(e=>e.uri).shift()}},{"../error.js":1,"../logs.js":5}],9:[function(e,t,r){var s=e("./error.js"),o=e("./logs.js"),n=(e("./tables"),e("./files")),a=e("./tables/utils.js").toSasDateTime;function i(e,t,r){if(e instanceof Array)this._files={},this.addTable(e,t,r);else{if(!(e instanceof File||e instanceof Blob))throw new s("argumentError","Data argument wrong type or missing");n.call(this,e,t)}}i.prototype.addTable=function(e,t,r){var n,i=!!r;if(!e||!t)throw new s("argumentError","Missing arguments");if(!(e instanceof Array))throw new s("argumentError","First argument must be array");if("string"!=typeof t)throw new s("argumentError","Second argument must be string");if(function(e){if(e.length>32)throw new s("argumentError","Table name too long. Maximum is 32 characters");var t=e.charCodeAt(0);if((t<65||t>90)&&(t<97||t>122)&&"_"!==e[0])throw new s("argumentError","Table name starting with number or special characters");for(var r=0;r<e.length;r++){var o=e.charCodeAt(r);if((o<48||o>57)&&(o<65||o>90)&&(o<97||o>122)&&"_"!==e[r])throw new s("argumentError","Table name has unsupported characters")}}(t),"object"!=typeof e||!(e instanceof Array))throw new s("argumentError","Table argument is not an array");if(r){if(r.constructor!==Object)throw new s("argumentError","Specs data type wrong. Object expected.");for(n in e[0])if(!r[n])throw new s("argumentError","Missing columns in specs data.");for(n in r){if(r[n].constructor!==Object)throw new s("argumentError","Wrong column descriptor in specs data.");if(!r[n].colType||!r[n].colLength)throw new s("argumentError","Missing columns in specs descriptor.")}}var l,c,u,p,g,h=[],f=['"',"\\","/","\n","\t","\f","\r","\b"];if(r)h=Object.keys(r);else for(r={},l=0;l<e.length;l++){if("object"!=typeof(u=e[l]))throw new s("argumentError","Table item is not an object");for(n in u)u.hasOwnProperty(n)&&(g=typeof(p=u[n]),void 0===r[n]&&(h.push(n),r[n]={},"number"===g?((p<Number.MIN_SAFE_INTEGER||p>Number.MAX_SAFE_INTEGER)&&o.addApplicationLog("Object["+l+"]."+n+" - This value exceeds expected numeric precision."),r[n].colType="num",r[n].colLength=8):"string"!==g||p instanceof Date?p instanceof Date?(r[n].colType="date",r[n].colLength=8):"object"===g&&(r[n].colType="json",r[n].colLength=JSON.stringify(p).length):(r[n].colType="string",r[n].colLength=p.length)))}var d="";for(l=0;l<e.length;l++){for(u=e[l],c=0;c<h.length;c++){if(n=h[c],u.hasOwnProperty(n)){if("number"===(g=typeof(p=u[n]))&&isNaN(p))throw new s("typeError","NaN value in one of the values (columns) is not allowed");if(p===-1/0||p===1/0)throw new s("typeError",p.toString()+" value in one of the values (columns) is not allowed");if(!0===p||!1===p)throw new s("typeError","Boolean value in one of the values (columns) is not allowed");if("string"===g&&-1!==p.indexOf("\r\n"))throw new s("typeError","New line character is not supported");if(null===p)if("string"===r[n].colType)p="",g="string";else{if("num"!==r[n].colType)throw new s("typeError","Cannot convert null value");p=".",g="number"}if("number"===g&&"num"!==r[n].colType&&"."!==p||"string"===g&&!(p instanceof Date)&&"string"!==r[n].colType&&"string"===g&&"num"==r[n].colType&&"."!==p||p instanceof Date&&"date"!==r[n].colType||"object"===g&&p.constructor!==Date&&"json"!==r[n].colType)throw new s("typeError","There is a specs type mismatch in the array between values (columns) of the same name. type/colType/val = "+g+"/"+r[n].colType+"/"+p);if(!i&&"string"===g&&r[n].colLength<p.length)r[n].colLength=p.length;else if("string"===g&&r[n].colLength<p.length||"string"!==g&&8!==r[n].colLength)throw new s("typeError","There is a specs length mismatch in the array between values (columns) of the same name. type/colType/val = "+g+"/"+r[n].colType+"/"+p);switch(p instanceof Date&&(p=a(p)),r[n].colType){case"num":case"date":d+=p;break;case"string":d+='"'+p.replace(/"/g,'""')+'"';for(var m=p.length,b=0;b<p.length;b++)if(-1!==f.indexOf(p[b]))m++;else{var w=p.charCodeAt(b);w>65535?m+=3:w>2047?m+=2:w>127&&(m+=1)}r[n].colLength=Math.max(r[n].colLength,m,1);break;case"object":d+='"'+JSON.stringify(p).replace(/"/g,'""')+'"'}}c<h.length-1&&(d+=",")}l<e.length-1&&(d+="\r\n")}var y=h.map((function(e){return e+","+r[e].colType+","+r[e].colLength})).join("|");this._files[t]=[y,new Blob([d],{type:"text/csv;charset=UTF-8"})]},i.prototype.addFile=function(e,t){n.prototype.add.call(this,e,t)},t.exports=i},{"./error.js":1,"./files":2,"./logs.js":5,"./tables":10,"./tables/utils.js":11}],10:[function(e,t,r){var s=e("../error.js");function o(e,t,r){this._tables={},this._parameterThreshold=r||3e4,o.prototype.add.call(this,e,t)}o.prototype.add=function(e,t){if(!e||!t)throw new s("argumentError","Missing arguments");if(!(e instanceof Array))throw new s("argumentError","First argument must be array");if("string"!=typeof t)throw new s("argumentError","Second argument must be string");if(!isNaN(t[t.length-1]))throw new s("argumentError","Macro name cannot have number at the end");var r=this._utils.convertTableObject(e,this._parameterThreshold),o=[];o.push(JSON.stringify(r.spec));for(var n=0;n<r.data.length;n++){var a=JSON.stringify(r.data[n]);o.push(a)}this._tables[t]=o},o.prototype._utils=e("./utils.js"),t.exports=o},{"../error.js":1,"./utils.js":11}],11:[function(e,t,r){var s=e("../error.js"),o=e("../logs.js");t.exports.convertTableObject=function(e,t){if(t>3e4&&console.warn("You should not set threshold larger than 30kb because of the SAS limitations"),"object"!=typeof e)throw new s("argumentError","The parameter passed to checkAndGetTypeObject is not an object");if("number"!=typeof e.length)throw new s("argumentError","The parameter passed to checkAndGetTypeObject does not have a valid length and is most likely not an array");var r={};var n=0,a=[],i=0;a[i]=[];for(var l,c=0,u=0;u<e.length;u++){a[i][c]={};var p=0;for(var g in e[u]){var h={},f=e[u][g];if(null!=f){if("number"==typeof f&&isNaN(f))throw new s("typeError","NaN value in one of the values (columns) is not allowed");if(f===-1/0||f===1/0)throw new s("typeError",f.toString()+" value in one of the values (columns) is not allowed");if(!0===f||!1===f)throw new s("typeError","Boolean value in one of the values (columns) is not allowed");var d=typeof f;if("number"===d)(f<Number.MIN_SAFE_INTEGER||f>Number.MAX_SAFE_INTEGER)&&o.addApplicationLog("Object["+u+"]."+g+" - This value exceeds expected numeric precision."),h.colName=g,h.colType="num",h.colLength=8,h.encodedLength=f.toString().length,a[i][c][g]=f;else if("string"===d)h.colName=g,h.colType="string",h.colLength=f.length,a[i][c][g]=""===f?" ":encodeURIComponent(f).replace(/'/g,"%27"),h.encodedLength=a[i][c][g].length;else{if(f instanceof Date)throw console.log("ERROR VALUE ",f),console.log("TYPEOF VALUE ",typeof f),new s("typeError","Date type not supported. Please use h54s.toSasDateTime function to convert it");"object"==d&&(h.colName=g,h.colType="json",h.colLength=JSON.stringify(f).length,a[i][c][g]=encodeURIComponent(JSON.stringify(f)).replace(/'/g,"%27"),h.encodedLength=a[i][c][g].length)}if(p=p+6+g.length+h.encodedLength,-1==(void 0===r[(l=h).colName]?(r[l.colName]={},r[l.colName].colName=l.colName,r[l.colName].colType=l.colType,r[l.colName].colLength=l.colLength>0?l.colLength:1,0):r[l.colName].colType!==l.colType?-1:r[l.colName].colLength<l.colLength?(r[l.colName].colLength=l.colLength>0?l.colLength:1,0):void 0))throw new s("typeError","There is a type mismatch in the array between values (columns) of the same name.")}}if(0!==Object.keys(a[i][c]).length){if(p>t)throw new s("argumentError","Row "+c+" exceeds size limit of 32kb");if(n+p>t){var m=a[i].pop();a[++i]=[m],c=0,n=p}else n+=p;c++}else a[i].splice(c,1)}var b=[];for(var w in r)b.push(r[w]);return{spec:b,data:a,jsonLength:n}},t.exports.toSasDateTime=function(e){var t=new Date("January 1, 1960 00:00:00"),r=e,s=t.getTimezoneOffset(),o=60*(r.getTimezoneOffset()-s),n=t.getTime()/1e3,a=r.getTime()/1e3;return Math.round(a-n-o)}},{"../error.js":1,"../logs.js":5}]},{},[3])(3)}));
